# -*- coding: utf-8 -*-
"""weather-prediction-model PROJECT.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1-Ric2ZOk-GNpJeUvXklGasHtWA9ITEP6
"""

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

data=pd.read_csv("/content/seattle-weather.csv")

data.head()

"""READ DATASET"""

import pandas as pd
import io

# If you have uploaded the file 'seattle-weather.csv' manually,
# you can run the following to make sure it's in the correct place:
# from google.colab import files
# uploaded = files.upload() # This will prompt you to upload files

# Assuming the file is now in the /content/ directory or uploaded:
data=pd.read_csv("/content/seattle-weather.csv")
data.tail()

plt.figure(figsize=(10,5))
sns.set_theme()
sns.countplot(x='weather', data=data, palette="ch:start=.2,rot=-.3")
plt.xlabel("weather", fontweight='bold', size=13)
plt.ylabel("Count", fontweight='bold', size=13)
plt.show()

plt.xlabel("Date", fontweight='bold', size=13)
plt.ylabel("Temp_Min", fontweight='bold', size=13)
plt.show()

"""MINIMUM AND MAXIMUM TEMPERATURE WITH DATE"""

plt.figure(figsize=(18,8))
sns.set_theme()
sns.lineplot(x='date', y='temp_min', data=data)
plt.xlabel("Date", fontweight='bold', size=13)
plt.ylabel("Temp_Min", fontweight='bold', size=13)
plt.show()

plt.xlabel("Date", fontweight='bold', size=13)
plt.ylabel("wind", fontweight='bold', size=13)
plt.show()

plt.figure(figsize=(14,8))
sns.pairplot(data.drop('date',axis=1), hue='weather', palette="YlOrBr")
plt.show()

"""GRAPH ALONG WIND AND WEATHER"""

plt.figure(figsize=(10,5))
sns.catplot(x='weather', y='wind', data=data, palette="magma")
plt.show()

"""WEATHER VS PRECIPITATION"""

sns.catplot(x='weather', y='precipitation', data=data, palette="viridis")
plt.show()

fig, axes = plt.subplots(2, 2, figsize=(18, 10))

fig.suptitle('Price Range vs all numerical factor') # Note: The title seems irrelevant to the data used in the plots (weather factors)

sns.scatterplot(ax=axes[0, 0], data=data, x='weather', y='precipitation')
sns.scatterplot(ax=axes[0, 1], data=data, x='weather', y='temp_max')
sns.scatterplot(ax=axes[1, 0], data=data, x='weather', y='temp_min')
sns.scatterplot(ax=axes[1, 1], data=data, x='weather', y='wind')
plt.show()

"""SPLITTING DATASET INTO TRAIN AND TEST"""

from sklearn.model_selection import train_test_split

# Define X (features) and y (target variable)
# Assuming 'weather' is the target variable and the rest are features
X = data.drop(['weather', 'date'], axis=1) # Dropped 'date' column
y = data['weather']

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.25, random_state = 0)

print(X_train.shape)
print(X_test.shape)
print(y_train.shape)
print(y_test.shape)

"""USE OF LOGISTIC REGRESSION"""

from sklearn.preprocessing import StandardScaler
sc = StandardScaler()
X_train = sc.fit_transform(X_train)
X_test = sc.transform(X_test)

from sklearn.linear_model import LogisticRegression
classifier = LogisticRegression(random_state = 0)
classifier.fit(X_train, y_train)

print("\t\tWelcome to the Weather Forecaster!\n\n")
print("Just Enter the City you want the weather report for and click on the button! It's that simple!\n\n")

city_name = input("Enter the name of the City : ")

import requests

# [Continuation of the script]

def Gen_report(C):
    # Construct the API URL using the city name (C)
    url = 'https://wttr.in/{}'.format(C)

    try:
        # Make a GET request to the weather API
        data = requests.get(url)
        # Extract the text content (which includes the formatted weather report)
        T = data.text
    except:
        # Handle potential connection or request errors
        T = "Error Occurred"

    # Print the resulting text (either the report or the error message)
    print(T)

# Call the function using the city name entered earlier (e.g., 'mudhol')
Gen_report(city_name)